{
    "$schema": "<relative path to createFormUI.schema.json>",
    "view": {
        "kind": "Form",
        "properties": {
            "title": "ANS Power Platform Landing Zones",
            "steps": [
                {
                    "name": "powerp",
                    "label": "Deployment Setup",
                    "subLabel": {},
                    "bladeTitle": "powerp",
                    "elements": [                        
                        {
                            "name": "spn",
                            "type": "Microsoft.Common.Section",
                            "label": "Existing User Managed Identity Configuration",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "SpnBox",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "The setup requires an existing User Assigned Identity that has been granted RBAC to the Power Platform to complete the deployment.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/power-platform/admin/powerplatform-api-create-service-principal"
                                }
                            }
                        },
                        {
                            "name": "ppIdentity",
                            "type": "Microsoft.Solutions.ResourceSelector",
                            "label": "Select an existing User Assigned Identity with permissions to the Power Platform APIs",
                            "resourceType": "Microsoft.ManagedIdentity/userAssignedIdentities",
                            "options": {
                                "filter": {
                                    "subscription": "all",
                                    "location": "all"
                                }
                            }
                        },
                        {
                            "name": "sub",
                            "type": "Microsoft.Common.Section",
                            "label": "Azure subscription",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "azureBox",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "The setup requires an existing Azure subscription to provision the required infrastructure and components, both in Azure and in Power Platform. Select a subscription and a region where the deployment should be placed.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/azure/azure-resource-manager/templates/deploy-to-subscription?tabs=azure-cli"
                                }
                            }
                        },
                        {
                            "name": "subscriptionApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "subscriptions?api-version=2020-01-01"
                            }
                        },
                        {
                            "name": "subscriptionId",
                            "label": "Subscription",
                            "type": "Microsoft.Common.DropDown",
                            "visible": true,
                            "defaultValue": "",
                            "toolTip": "Select the Subscription for the deployment.",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "constraints": {
                                "allowedValues": "[map(steps('powerp').subscriptionApi.value, (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.id, '\",\"description\":\"', 'ID: ', item.subscriptionId, '\"}')))]",
                                "required": true
                            }
                        },
                        {
                            "name": "locationsApi",
                            "type": "Microsoft.Solutions.ArmApiControl",
                            "request": {
                                "method": "GET",
                                "path": "locations?api-version=2019-11-01"
                            }
                        },
                        {
                            "name": "locationName",
                            "label": "Location",
                            "type": "Microsoft.Common.DropDown",
                            "visible": true,
                            "defaultValue": "",
                            "toolTip": "Select the Location for the deployment.",
                            "multiselect": false,
                            "selectAll": false,
                            "filter": true,
                            "filterPlaceholder": "Filter items ...",
                            "multiLine": true,
                            "constraints": {
                                "allowedValues": "[map(steps('powerp').locationsApi.value,(item) => parse(concat('{\"label\":\"',item.displayName,'\",\"value\":\"',item.name,'\"}')))]",
                                "required": true
                            }
                        }                        
                    ]
                },
                {
                    "name": "tenant",
                    "label": "Tenant Setup",
                    "elements": [                                                                 
                        {
                            "name": "tenantIsolationSetting",
                            "type": "Microsoft.Common.Section",
                            "label": "Tenant isolation",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "tenantIsolationText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Configure tenant isolation to block external tenants from establishing connections into your tenant (inbound isolation) as well as block your tenant from establishing connections to external tenants (outbound isolation).",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/power-platform/admin/cross-tenant-restrictions"
                                }
                            }
                        },
                        {
                            "name": "ppTenantIsolationSetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable tenant isolation",
                            "defaultValue": "Block both inbound and outbound",                                                        
                            "toolTip": "Select the preferred tenant isolation method by selecting either inbound, outbound, or both.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Block inbound",
                                        "value": "inbound"
                                    },
                                    {
                                        "label": "Block outbound",
                                        "value": "outbound"
                                    },
                                    {
                                        "label": "Block both inbound and outbound",
                                        "value": "both"
                                    },
                                    {
                                        "label": "Do not enable tenant isolation",
                                        "value": "none"
                                    }
                                ],
                                "required": true                                
                            },
                            "visible": true
                        }, 
                        
                        
                        
                        {
                            "name": "tenantGuestsAndSharing",
                            "type": "Microsoft.Common.Section",
                            "label": "Tenant Guest user and sharing settings",
                            "elements": [],
                            "visible": true                            
                        },
                        {
                            "name": "tenantText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Configure tenant guest and sharing options.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/powerapps/maker/model-driven-apps/share-model-driven-app#app-sharing-privilege-and-licensing-requirements"
                                }
                            }
                        },
                        {
                            "name": "ppGuestMakerSetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Prevent Azure AD guests accounts to make Power Apps",
                            "defaultValue": "Yes",
                            "multiSelect": true,                            
                            "toolTip": "If 'Yes' is selected, the setup will configure this setting.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "ppAppSharingSetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Restrict sharing of PowerApps with the entire organization",
                            "defaultValue": "Yes",
                            "multiSelect": true,                            
                            "toolTip": "If 'Yes' is selected, the setup will configure this setting.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },                        
                        {
                            "name": "tenantEnv",
                            "type": "Microsoft.Common.Section",
                            "label": "Tenant Environment settings",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "tenantEnvText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Configure the overall Environment settings for the tenant. These settings will allow you to control Environment creation process, and capacity management.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/power-platform/admin/environments-overview"
                                }
                            }
                        },
                        {
                            "name": "ppEnvCreationSetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Restrict production and sandbox Environment creation to specific Admins",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will configure this setting.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "ppTrialEnvCreationSetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Restrict trial Environment creation to specific Admins",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will configure this setting",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "ppEnvCapacitySetting",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Restrict capacity allocation to specific Admins",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will configure this option.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        }                        
                    ]
                },                                               
                {
                    "name": "landingZones",
                    "label": "Landing Zones Setup",
                    "elements": [                       
                        {
                            "name": "default",
                            "type": "Microsoft.Common.Section",
                            "label": "Default environment",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "defaultText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "The Default Environment is available for all users with a license. It is recommended to rename this Environment to clarify the intent of it, such as 'Personal Productivity', and add further restrictions using Data-lose prevention policies scoped to the Default Environment",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://www.microsoft.com"
                                }
                            }
                        },
                        {
                            "name": "ppDefaultRename",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Rename the default environment",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will rename the environment",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "ppDefaultRenameText",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Provide a new name for the default environment",
                            "placeholder": "PersonalProductivity",
                            "defaultValue": "PersonalProductivity",
                            "toolTip": "Use only allowed characters",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z]{1,30}$",
                                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                            },
                            "visible": "[equals(steps('landingZones').ppDefaultRename, 'yes')]"
                        },
                        {
                            "name": "ppDefaultDlp",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Assign recommended Data-loss prevention policies to the Default Environment",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will enable this",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('landingZones').ppDefaultRename, 'yes')]"
                        },
						{
                            "name": "ppDefaultManagedText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": "[equals(steps('landingZones').ppDefaultRename, 'yes')]",
                            "options": {
                                "text": "Enabling Managed Environment in this step will opt-in to weekly digest, and allow you to continue the configuration in Power Platform Admin Center for sharing restrictions, DLPs and more post deployment.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/power-platform/admin/managed-environment-overview"
                                }
                            }
                        },
                        {
                            "name": "ppDefaultManagedEnv",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Managed Environments (Preview) for the Default Environment",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "Managed Environments is a suite of capabilities that allows admins to manage Power Platform at scale with more control, less effort, and more insights",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ],
                                "required": true
                            },
                            "visible": "[equals(steps('landingZones').ppDefaultRename, 'yes')]"
                        },
                        {
                            "name": "ppDefaultManagedSharing",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Exclude sharing with security groups",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "Help reduce risk by limiting how widely canvas apps can be shared.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ],
                                "required": true
                            },
                            "visible": "[and(equals(steps('landingZones').ppDefaultRename, 'yes'), equals(steps('landingZones').ppDefaultManagedEnv, 'yes'))]"
                        },
                        {
                            "name": "citizenSection",
                            "type": "Microsoft.Common.Section",
                            "label": "Landing Zones (Environments)",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "citizenText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "The Landing Zones (Environments) will be created and provide them with the required agility and simplicity to rapidly build modern business applications. You can grant business units or indivuduals access to the Environments post creation.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://learn.microsoft.com/en-us/power-platform/admin/environments-overview"
                                }
                            }
                        },
                        {
                            "name": "ppCitizen",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Create Environments for citizen developer scenarios",
                            "defaultValue": "Yes",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will create new environments",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "yes"
                                    },                                    
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "callGraph",
                            "type": "Microsoft.Solutions.GraphApiControl",
                            "request": {
                                "method": "GET",
                                "path": "/beta/groups?&select=displayName,id",
                                "transforms": {
                                    "list": "value|[*].{label:displayName, value:id}"
                                }
                            }
                        },                                             
                        {
                            "name": "ppCitizenNaming",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Provide naming convention for the environments.",
                            "placeholder": "",
                            "defaultValue": "",
                            "toolTip": "Use only allowed characters",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z]{1,30}$",
                                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                            },
                            "visible": true
                        },                        
                        {
                            "name": "ppCitizenRegion",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select region for the new Environments.",
                            "placeholder": "",
                            "defaultValue": "United Kingdom",
                            "toolTip": "",
                            "filter": true,
                            "visible": true,
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Europe",
                                        "value": "europe"
                                    },
                                    {
                                        "label": "United Kingdom",
                                        "value": "unitedkingdom"
                                    },
                                    {
                                        "label": "United States",
                                        "value": "unitedstates"
                                    },
                                    {
                                        "label": "United Arab Emirates",
                                        "value": "unitedarabemirates"
                                    },
                                    {
                                        "label": "Asia",
                                        "value": "asia"
                                    },
                                    {
                                        "label": "India",
                                        "value": "india"
                                    },
                                    {
                                        "label": "Japan",
                                        "value": "japan"
                                    },
                                    {
                                        "label": "France",
                                        "value": "france"
                                    },
                                    {
                                        "label": "Germany",
                                        "value": "germany"
                                    },
                                    {
                                        "label": "Australia",
                                        "value": "australia"
                                    },
                                    {
                                        "label": "Canada",
                                        "value": "canada"
                                    },
                                    {
                                        "label": "South America",
                                        "value": "southamerica"
                                    },
                                    {
                                        "label": "Norway",
                                        "value": "norway"
                                    }
                                ],
                                "required": true
                            }
                        },
                        {
                            "name": "ppCitizenLanguage",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select language for the new Environments.",
                            "placeholder": "",
                            "defaultValue": "English (United States)",
                            "toolTip": "",
                            "filter": true,
                            "visible": true,
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Arabic",
                                        "value": "1025"
                                    },
                                    {
                                        "label": "Bulgarian",
                                        "value": "1026"
                                    },
                                    {
                                        "label": "Catalan",
                                        "value": "1027"
                                    },
                                    {
                                        "label": "Chinese (Taiwan)",
                                        "value": "1028"
                                    },
                                    {
                                        "label": "Czech",
                                        "value": "1029"
                                    },
                                    {
                                        "label": "Danish",
                                        "value": "1030"
                                    },
                                    {
                                        "label": "German",
                                        "value": "1031"
                                    },
                                    {
                                        "label": "Greek",
                                        "value": "1032"
                                    },
                                    {
                                        "label": "English (United States)",
                                        "value": "1033"
                                    },
                                    {
                                        "label": "Finnish",
                                        "value": "1035"
                                    },
                                    {
                                        "label": "French",
                                        "value": "1036"
                                    },
                                    {
                                        "label": "Hebrew",
                                        "value": "1037"
                                    },
                                    {
                                        "label": "Hungarian",
                                        "value": "1038"
                                    },
                                    {
                                        "label": "Italian",
                                        "value": "1040"
                                    },
                                    {
                                        "label": "Japanese",
                                        "value": "1041"
                                    },
                                    {
                                        "label": "Korean",
                                        "value": "1042"
                                    },
                                    {
                                        "label": "Dutch",
                                        "value": "1043"
                                    },
                                    {
                                        "label": "Norwegian",
                                        "value": "1044"
                                    },
                                    {
                                        "label": "Polish",
                                        "value": "1045"
                                    },
                                    {
                                        "label": "Brazilian",
                                        "value": "1046"
                                    },
                                    {
                                        "label": "Romanian",
                                        "value": "1048"
                                    },
                                    {
                                        "label": "Russian",
                                        "value": "1049"
                                    },
                                    {
                                        "label": "Croatian",
                                        "value": "1050"
                                    },
                                    {
                                        "label": "Slovak",
                                        "value": "1051"
                                    },
                                    {
                                        "label": "Swedish",
                                        "value": "1053"
                                    },
                                    {
                                        "label": "Thai",
                                        "value": "1054"
                                    },
                                    {
                                        "label": "Turkish",
                                        "value": "1055"
                                    },
                                    {
                                        "label": "Indonesian",
                                        "value": "1057"
                                    },
                                    {
                                        "label": "Ukrainian",
                                        "value": "1058"
                                    },
                                    {
                                        "label": "Slovenian",
                                        "value": "1060"
                                    },
                                    {
                                        "label": "Estonian",
                                        "value": "1061"
                                    },
                                    {
                                        "label": "Latvian",
                                        "value": "1062"
                                    },
                                    {
                                        "label": "Lithuanian",
                                        "value": "1063"
                                    },
                                    {
                                        "label": "Viatnamese",
                                        "value": "1066"
                                    },
                                    {
                                        "label": "Basque (Spain)",
                                        "value": "1069"
                                    },
                                    {
                                        "label": "Hindi (Latin)",
                                        "value": "1081"
                                    },
                                    {
                                        "label": "Malay",
                                        "value": "1086"
                                    },
                                    {
                                        "label": "Kazakh",
                                        "value": "1087"
                                    },
                                    {
                                        "label": "Galician (Spain)",
                                        "value": "1110"
                                    },
                                    {
                                        "label": "Chinese (Simplified)",
                                        "value": "2052"
                                    },
                                    {
                                        "label": "Portuguese",
                                        "value": "2070"
                                    },
                                    {
                                        "label": "Serbian (Latin)",
                                        "value": "2074"
                                    },
                                    {
                                        "label": "Chinese (Traditional)",
                                        "value": "3076"
                                    },
                                    {
                                        "label": "Modern Spanish (Spain)",
                                        "value": "3082"
                                    },
                                    {
                                        "label": "Serbian (Cyrillic)",
                                        "value": "3089"
                                    }
                                ],
                                "required": true
                            }
                        },
                        {
                            "name": "ppCitizenCurrency",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select currency for the new Environments.",
                            "placeholder": "",
                            "defaultValue": "GBP",
                            "toolTip": "",
                            "filter": true,
                            "visible": true,
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "AED",
                                        "value": "aed"
                                    },
                                    {
                                        "label": "AFN",
                                        "value": "afn"
                                    },
                                    {
                                        "label": "ALL",
                                        "value": "all"
                                    },
                                    {
                                        "label": "AMD",
                                        "value": "amd"
                                    },
                                    {
                                        "label": "ARS",
                                        "value": "ars"
                                    },
                                    {
                                        "label": "AUD",
                                        "value": "aud"
                                    },
                                    {
                                        "label": "AZN",
                                        "value": "azn"
                                    },
                                    {
                                        "label": "BAM",
                                        "value": "bam"
                                    },
                                    {
                                        "label": "BDT",
                                        "value": "bdt"
                                    },
                                    {
                                        "label": "BGN",
                                        "value": "bgn"
                                    },
                                    {
                                        "label": "BHD",
                                        "value": "bhd"
                                    },
                                    {
                                        "label": "BND",
                                        "value": "bmd"
                                    },
                                    {
                                        "label": "BOB",
                                        "value": "bob"
                                    },
                                    {
                                        "label": "BRL",
                                        "value": "brl"
                                    },
                                    {
                                        "label": "BTN",
                                        "value": "btn"
                                    },
                                    {
                                        "label": "BWP",
                                        "value": "bwp"
                                    },
                                    {
                                        "label": "BYN",
                                        "value": "byn"
                                    },
                                    {
                                        "label": "BZD",
                                        "value": "bzd"
                                    },
                                    {
                                        "label": "CAD",
                                        "value": "cad"
                                    },
                                    {
                                        "label": "CDF",
                                        "value": "cdf"
                                    },
                                    {
                                        "label": "CHF",
                                        "value": "chf"
                                    },
                                    {
                                        "label": "CLP",
                                        "value": "clp"
                                    },
                                    {
                                        "label": "CNY",
                                        "value": "cny"
                                    },
                                    {
                                        "label": "COP",
                                        "value": "cop"
                                    },
                                    {
                                        "label": "CRC",
                                        "value": "crc"
                                    },
                                    {
                                        "label": "CUP",
                                        "value": "cup"
                                    },
                                    {
                                        "label": "CZK",
                                        "value": "czk"
                                    },
                                    {
                                        "label": "DJF",
                                        "value": "djf"
                                    },
                                    {
                                        "label": "DKK",
                                        "value": "dkk"
                                    },
                                    {
                                        "label": "DOP",
                                        "value": "dop"
                                    },
                                    {
                                        "label": "DZD",
                                        "value": "dzd"
                                    },
                                    {
                                        "label": "EGP",
                                        "value": "EGP"
                                    },
                                    {
                                        "label": "ERN",
                                        "value": "ERN"
                                    },
                                    {
                                        "label": "ETB",
                                        "value": "etb"
                                    },
                                    {
                                        "label": "EUR",
                                        "value": "eur"
                                    },
                                    {
                                        "label": "GBP",
                                        "value": "gbp"
                                    },
                                    {
                                        "label": "GEL",
                                        "value": "gel"
                                    },
                                    {
                                        "label": "GTQ",
                                        "value": "gtq"
                                    },
                                    {
                                        "label": "HKD",
                                        "value": "hkd"
                                    },
                                    {
                                        "label": "HNL",
                                        "value": "hnl"
                                    },
                                    {
                                        "label": "HRK",
                                        "value": "hrk"
                                    },
                                    {
                                        "label": "HTG",
                                        "value": "htg"
                                    },
                                    {
                                        "label": "HUF",
                                        "value": "huf"
                                    },
                                    {
                                        "label": "IDR",
                                        "value": "idr"
                                    },
                                    {
                                        "label": "ILS",
                                        "value": "ils"
                                    },
                                    {
                                        "label": "INR",
                                        "value": "inr"
                                    },
                                    {
                                        "label": "IQD",
                                        "value": "iqd"
                                    },
                                    {
                                        "label": "IRR",
                                        "value": "irr"
                                    },
                                    {
                                        "label": "ISK",
                                        "value": "isk"
                                    },
                                    {
                                        "label": "JMD",
                                        "value": "jmd"
                                    },
                                    {
                                        "label": "JOD",
                                        "value": "jod"
                                    },
                                    {
                                        "label": "JPY",
                                        "value": "jpy"
                                    },
                                    {
                                        "label": "KES",
                                        "value": "kes"
                                    },
                                    {
                                        "label": "KGS",
                                        "value": "kgs"
                                    },
                                    {
                                        "label": "KHR",
                                        "value": "khr"
                                    },
                                    {
                                        "label": "KWR",
                                        "value": "kwr"
                                    },
                                    {
                                        "label": "KWD",
                                        "value": "kwd"
                                    },
                                    {
                                        "label": " KZT",
                                        "value": "kzt"
                                    },
                                    {
                                        "label": "LAK",
                                        "value": "lak"
                                    },
                                    {
                                        "label": "LBP",
                                        "value": "lbp"
                                    },
                                    {
                                        "label": "LKR",
                                        "value": "lkr"
                                    },
                                    {
                                        "label": "LYD",
                                        "value": "lyd"
                                    },
                                    {
                                        "label": "MAD",
                                        "value": "mad"
                                    },
                                    {
                                        "label": "MDL",
                                        "value": "mdl"
                                    },
                                    {
                                        "label": "MKD",
                                        "value": "mkd"
                                    },
                                    {
                                        "label": "MMK",
                                        "value": "mmk"
                                    },
                                    {
                                        "label": "MNT",
                                        "value": "mnt"
                                    },
                                    {
                                        "label": "MOP",
                                        "value": "mop"
                                    },
                                    {
                                        "label": "MVR",
                                        "value": "mvr"
                                    },
                                    {
                                        "label": "MXN",
                                        "value": "mxn"
                                    },
                                    {
                                        "label": "MYR",
                                        "value": "myr"
                                    },
                                    {
                                        "label": "NGN",
                                        "value": "ngn"
                                    },
                                    {
                                        "label": "NIO",
                                        "value": " nio"
                                    },
                                    {
                                        "label": "NOK",
                                        "value": "nok"
                                    },
                                    {
                                        "label": "NPR",
                                        "value": "npr"
                                    },
                                    {
                                        "label": "NZD",
                                        "value": "nzd"
                                    },
                                    {
                                        "label": "OMR",
                                        "value": "omr"
                                    },
                                    {
                                        "label": "PAB",
                                        "value": "pab"
                                    },
                                    {
                                        "label": "PEN",
                                        "value": "pen"
                                    },
                                    {
                                        "label": "PHP",
                                        "value": "php"
                                    },
                                    {
                                        "label": "PKR",
                                        "value": "pkr"
                                    },
                                    {
                                        "label": "PLN",
                                        "value": "pln"
                                    },
                                    {
                                        "label": "PYG",
                                        "value": "pyg"
                                    },
                                    {
                                        "label": "QAR",
                                        "value": "qar"
                                    },
                                    {
                                        "label": "RON",
                                        "value": "ron"
                                    },
                                    {
                                        "label": "RSD",
                                        "value": "rds"
                                    },
                                    {
                                        "label": "RUB",
                                        "value": "rub"
                                    },
                                    {
                                        "label": "RWF",
                                        "value": "rwf"
                                    },
                                    {
                                        "label": "SAR",
                                        "value": "sar"
                                    },
                                    {
                                        "label": "SEK",
                                        "value": "sek"
                                    },
                                    {
                                        "label": "SGD",
                                        "value": "sgd"
                                    },
                                    {
                                        "label": "SOS",
                                        "value": "sos"
                                    },
                                    {
                                        "label": "SYP",
                                        "value": "syp"
                                    },
                                    {
                                        "label": "THB",
                                        "value": "thb"
                                    },
                                    {
                                        "label": "TJS",
                                        "value": "tjs"
                                    },
                                    {
                                        "label": "TMT",
                                        "value": "tmt"
                                    },
                                    {
                                        "label": "TND",
                                        "value": "tnd"
                                    },
                                    {
                                        "label": "TRY",
                                        "value": "try"
                                    },
                                    {
                                        "label": "TTD",
                                        "value": "ttd"
                                    },
                                    {
                                        "label": "TWD",
                                        "value": "twd"
                                    },
                                    {
                                        "label": "UAH",
                                        "value": "uah"
                                    },
                                    {
                                        "label": "USD",
                                        "value": "usd"
                                    },
                                    {
                                        "label": "UYU",
                                        "value": "uyu"
                                    },
                                    {
                                        "label": "UZS",
                                        "value": "uzs"
                                    },
                                    {
                                        "label": "VES",
                                        "value": "ves"
                                    },
                                    {
                                        "label": "VND",
                                        "value": "vnd"
                                    },
                                    {
                                        "label": "XAF",
                                        "value": "xaf"
                                    },
                                    {
                                        "label": "XCD",
                                        "value": "xcd"
                                    },
                                    {
                                        "label": "XDR",
                                        "value": "xdr"
                                    },
                                    {
                                        "label": "XOF",
                                        "value": "xof"
                                    },
                                    {
                                        "label": "YER",
                                        "value": "yer"
                                    },
                                    {
                                        "label": "ZAR",
                                        "value": "zar"
                                    }
                                ],
                                "required": true
                            }
                        },
                        {
                            "name": "ppCitizenDlp",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Assign recommended Data-loss prevention policies to the Environments.",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will enable this",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": "[not(equals(steps('landingZones').ppCitizen, 'no'))]"
                        },
						{
                            "name": "ppCitizenManagedText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Enabling Managed Environment in this step will opt-in to weekly digest, and allow you to continue the configuration in Power Platform Admin Center for sharing restrictions, DLPs and more post deployment.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://docs.microsoft.com/power-platform/admin/managed-environment-overview"
                                }
                            }
                        },
                        {
                            "name": "ppCitizenManagedEnv",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Managed Environments (Preview) for the Environments.",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "Managed Environments is a suite of capabilities that allows admins to manage Power Platform at scale with more control, less effort, and more insights",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ],
                                "required": true
                            },
                            "visible": "[not(equals(steps('landingZones').ppCitizen, 'no'))]"
                        },
                        {
                            "name": "ppCitizenAlm",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Create Development, Test, and Production environments.",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "If 'Yes' is selected, the setup adhere to best practices and create dedicated environments for sustainable application life-cycle management",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": "[not(equals(steps('landingZones').ppCitizen, 'no'))]"
                        },                                                                                          
                        {
                            "name": "D365Section",
                            "type": "Microsoft.Common.Section",
                            "label": "Dynamics 365 Applications",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "d365AppsText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "The section for Dynamics 365 Apps are intended to select and install the D365 applications.",
                                "link": {
                                    "label": "Microsoft Dynamics 365",
                                    "uri": "https://www.microsoft.com/en-us/dynamics-365"
                                }
                            }
                        },
                        {
                            "name": "ppD365Apps",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Install D365 Apps?",
                            "defaultValue": "No",
                            "multiSelect": false,
                            "toolTip": "If 'Yes' is selected, the setup will install the selected D365 Apps",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },                        
                        {
                            "name": "ppD365SalesApp",
                            "type": "Microsoft.Common.CheckBox",
                            "label": "Dynamics 365 for Sales",                                                        
                            "constraints": {
                                "required": false
                            },
                            "visible": "[not(equals(steps('landingZones').ppD365Apps, 'no'))]"
                        },
                        {
                            "name": "ppD365CustomerServiceApp",
                            "type": "Microsoft.Common.CheckBox",
                            "label": "Dynamics 365 for Customer Service",                                                        
                            "constraints": {
                                "required": false
                            },
                            "visible": "[not(equals(steps('landingZones').ppD365Apps, 'no'))]"
                        },
                        {
                            "name": "ppD365FieldServiceApp",
                            "type": "Microsoft.Common.CheckBox",
                            "label": "Dynamics 365 for Field Service",                                                        
                            "constraints": {
                                "required": false
                            },
                            "visible": "[not(equals(steps('landingZones').ppD365Apps, 'no'))]"
                        },
                        {
                            "name": "adminEnv",
                            "type": "Microsoft.Common.Section",
                            "label": "Admin Environment configuration",
                            "elements": [],
                            "visible": true
                        },
                        {
                            "name": "adminEnvText",
                            "type": "Microsoft.Common.TextBlock",
                            "visible": true,
                            "options": {
                                "text": "Create new dedicated Admin Environments that should be used to operate and manage the overall Power Platform tenant, such as Environment creation, DLP management, Identity and Access, and analytics.",
                                "link": {
                                    "label": "Learn more",
                                    "uri": "https://aka.ms/NorthStarPowerPlatform"
                                }
                            }
                        },
                        {
                            "name": "ppAdminEnvEnablement",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Create dedicated Admin environments",
                            "defaultValue": "No",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will configure this option.",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "ppAdminEnvNaming",
                            "type": "Microsoft.Common.TextBox",
                            "label": "Provide naming convention for the Admin environments",
                            "placeholder": "",
                            "defaultValue": "",
                            "toolTip": "Use only allowed characters",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z]{1,30}$",
                                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                            },
                            "visible": "[equals(steps('landingZones').ppAdminEnvEnablement, 'yes')]"
                        },
                         {
                            "name": "ppAdminRegion",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Select region for the new Admin Environments",
                            "placeholder": "",
                            "defaultValue": "United Kingdom",
                            "toolTip": "",
                            "visible": "[equals(steps('landingZones').ppAdminEnvEnablement, 'yes')]",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Europe",
                                        "value": "europe"
                                    },
                                    {
                                        "label": "United States",
                                        "value": "unitedstates"
                                    },
                                    {
                                        "label": "United Kingdom",
                                        "value": "unitedkingdom"
                                    },
                                    {
                                        "label": "United Arab Emirates",
                                        "value": "unitedarabemirates"
                                    },
                                    {
                                        "label": "Asia",
                                        "value": "asia"
                                    },
                                    {
                                        "label": "India",
                                        "value": "india"
                                    },
                                    {
                                        "label": "Japan",
                                        "value": "japan"
                                    },
                                    {
                                        "label": "France",
                                        "value": "france"
                                    },
                                    {
                                        "label": "Germany",
                                        "value": "germany"
                                    },
                                    {
                                        "label": "Australia",
                                        "value": "australia"
                                    },
                                    {
                                        "label": "Canada",
                                        "value": "canada"
                                    },
                                    {
                                        "label": "South America",
                                        "value": "southamerica"
                                    },
                                    {
                                        "label": "Norway",
                                        "value": "norway"
                                    }
                                ],
                                "required": true
                            }
                        },  {
                            "name": "ppAdminDlp",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Assign recommended Data-loss prevention policies to the Admin Environments",
                            "defaultValue": "Yes (recommended)",
                            "multiSelect": true,
                            "toolTip": "If 'Yes' is selected, the setup will enable this",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ]
                            },
                            "visible": "[equals(steps('landingZones').ppAdminEnvEnablement, 'yes')]"
                        },
                        {
                            "name": "ppAdminManagedEnv",
                            "type": "Microsoft.Common.OptionsGroup",
                            "label": "Enable Managed Environments (Preview) for the Admin Environments",
                            "defaultValue": "Yes (recommended)",
                            "toolTip": "Managed Environments is a suite of capabilities that allows admins to manage Power Platform at scale with more control, less effort, and more insights",
                            "constraints": {
                                "allowedValues": [
                                    {
                                        "label": "Yes (recommended)",
                                        "value": "yes"
                                    },
                                    {
                                        "label": "No",
                                        "value": "no"
                                    }
                                ],
                                "required": true
                            },
                            "visible": "[equals(steps('landingZones').ppAdminEnvEnablement, 'yes')]"
                        }
                    ]
                }
               
            ]
        },
        "outputs": {
            "parameters": {
                "ppIdentity": "[steps('powerp').ppIdentity.id]",                                
                "ppTenantIsolationSetting": "[steps('tenant').ppTenantIsolationSetting]",
                "ppAdminEnvEnablement": "[steps('landingZones').ppAdminEnvEnablement]",
                "ppAdminEnvNaming": "[steps('landingZones').ppAdminEnvNaming]",
                "ppAdminRegion": "[steps('landingZones').ppAdminRegion]",
                "ppAdminDlp": "[steps('landingZones').ppAdminDlp]",
                "ppAdminManagedEnv": "[steps('landingZones').ppAdminManagedEnv]" ,  
                "ppGuestMakerSetting": "[steps('tenant').ppGuestMakerSetting]",
                "ppAppSharingSetting": "[steps('tenant').ppAppSharingSetting]",
                "ppEnvCreationSetting": "[steps('tenant').ppEnvCreationSetting]",
                "ppTrialEnvCreationSetting": "[steps('tenant').ppTrialEnvCreationSetting]",
                "ppEnvCapacitySetting": "[steps('tenant').ppEnvCapacitySetting]",
                "ppDefaultRenameText": "[steps('landingZones').ppDefaultRenameText]",
                "ppDefaultDlp": "[steps('landingZones').ppDefaultDlp]",
                "ppDefaultManagedEnv": "[steps('landingZones').ppDefaultManagedEnv]",
                "ppDefaultManagedSharing": "[steps('landingZones').ppDefaultManagedSharing]",
                "ppCitizen": "[steps('landingZones').ppCitizen]",                
                "ppCitizenNaming": "[steps('landingZones').ppCitizenNaming]",                
                "ppCitizenLanguage": "[steps('landingZones').ppCitizenLanguage]",
                "ppCitizenCurrency": "[steps('landingZones').ppCitizenCurrency]",
                "ppCitizenRegion": "[steps('landingZones').ppCitizenRegion]",
                "ppCitizenDlp": "[steps('landingZones').ppCitizenDlp]",
                "ppCitizenManagedEnv": "[steps('landingZones').ppCitizenManagedEnv]",
                "ppCitizenAlm": "[steps('landingZones').ppCitizenAlm]",                
                "ppD365SalesApp": "[steps('landingZones').ppD365SalesApp]",  
                "ppD365CustomerServiceApp": "[steps('landingZones').ppD365CustomerServiceApp]",   
                "ppD365FieldServiceApp": "[steps('landingZones').ppD365FieldServiceApp]" 
                          
            },
            "kind": "Subscription",
            "location": "[steps('powerp').locationName]",
            "subscriptionId": "[steps('powerp').subscriptionId]"
        }
    }
}
